<html>
<head>
    <style>
        table, th, td {
            border: 1px solid black;
            padding: 5px;
        }
    </style>

    <script>
        function doStuff() {
            var address = document.getElementById('address').value;
            var supernet = parseInt(document.getElementById('supernet').value);
            var subnet = parseInt(document.getElementById('subnet').value);
            var start = document.getElementById('start').value ? parseInt(document.getElementById('start').value) : 0;
            var count = document.getElementById('count').value ? parseInt(document.getElementById('count').value) : -1;

            var outputArray = [];

            var supernetStart = address;
            var supernetEnd = getCidrEnd(supernetStart, supernet);

            outputArray.push(['supernet: ', supernetStart, supernetEnd]);
            outputArray.push(['==========']);

            var currentSubnetStart = supernetStart;
            var i = 0;
            while (ipTextToNum(currentSubnetStart) <= ipTextToNum(supernetEnd)) {
                i++;
                var subnetEnd = getCidrEnd(currentSubnetStart, subnet);

                outputArray.push(['subnet '+i+': ', currentSubnetStart, subnetEnd, addToIp(currentSubnetStart, start), count == -1 ? subnetEnd : addToIp(currentSubnetStart, start+count)]);
                currentSubnetStart = addToIp(subnetEnd, 1);
            }

            // output, the ugly way...
            output = 'Total subnets: ' + i;
            output += '<br><br>';
            output += '<table>';
            output += '<tr>';
            output += '<th></th><th colspan="2">global</th><th colspan="2">with Range Start and Num Addresses</th><tr>';
            output += '<th></th><th>Start</th><th>End</th><th>Start</th><th>End</th><tr>';
            outputArray.forEach(function (line, index) {
                output += '<tr>';
                line.forEach(function (col, index2) {
                    output += '<td>';
                    output += col;
                    output += '</td>';
                });
                output += '</tr>';
            });
            output += '</table>';
            document.getElementById('mydiv').innerHTML = output;
        }

        function ipTextToNum(iptext) {
            var sub = iptext.split('.').map(function(a) {return parseInt(a)} );
            var i32 = new Uint32Array(new ArrayBuffer(4));
            i32[0]  = (sub[0]<<24) + (sub[1]<<16) + (sub[2]<<8) + (sub[3]);
            return i32[0];
        }

        function getCidrEnd(ip, cidrSubnet) {
            var off = (1<<(32-cidrSubnet))-1; 
            return addToIp(ip, off);
        }

        function addToIp(ip, addition) {
            var sub = ip.split('.').map(function(a) {return parseInt(a)} );
            var buf = new ArrayBuffer(4); 
            var i32 = new Uint32Array(buf); 
            i32[0] = (sub[0]<<24) + (sub[1]<<16) + (sub[2]<<8) + (sub[3]);
            i32[0] += addition;
            var end = Array.apply([],new Uint8Array(buf)).reverse().join('.');
            return end;
        }

        function canned1() {
            document.getElementById('address').value = '192.168.0.0';
            document.getElementById('supernet').value = 16;
            document.getElementById('subnet').value = 24;
            document.getElementById('start').value = 50;
            document.getElementById('count').value = 150;
            doStuff();
        }
        function canned2() {
            document.getElementById('address').value = '192.168.0.0';
            document.getElementById('supernet').value = 24;
            document.getElementById('subnet').value = 30;
            document.getElementById('start').value = 1;
            document.getElementById('count').value = '';
            doStuff();
        }
        function canned3() {
            document.getElementById('address').value = '10.0.0.1';
            document.getElementById('supernet').value = 30;
            document.getElementById('subnet').value = 32;
            document.getElementById('start').value = '';
            document.getElementById('count').value = '';
            doStuff();
        }


    </script>
</head>
<body>

<h2>The Supernet and Subnets calculatinator!</h2>
Or... Doron was curious... :)
<br>
<br>
Change input fields below and click the "Calculate!". Use at your own risk, absolutely no validitations... 
<br>
Alternatively, click one of the "canned example" buttons
<br>
<table>
    <tr><td><label for="address">Address:</label></td>
    <td><input type="text" id="address" name="address" value="192.168.0.0"></td>
    <td>the address component to be used for the supernet and subnet. If your CIDR is 192.168.0.1/32, then this will be the 192.168.0.1 part..</td></tr>
    <tr><td><label for="supernet">Supernet:</label></td>
    <td><input type="text" id="supernet" name="supernet" value="16"></td>
    <td>CIDR suffix to determine the size of the supernet, should be bigger than its subnets, so this input should be smaller than your "Subnet" input</td></tr>
    <tr><td><label for="subnet">Subnet:</label></td>
    <td><input type="text" id="subnet" name="subnet" value="24"></td>
    <td>CIDR suffix to determine the size of each subnet in the supernet. This input should be smaller than your "Supernet" input</td></tr>
    <tr><td><label for="start">Range Start:</label></td>
    <td><input type="text" id="start" name="start" value="50"></td>
    <td>(optional) out of all IPs in the subnet range, start with this Nth IP address</td></tr>
    <tr><td><label for="count">Number of Addresses:</label></td>
    <td><input type="text" id="count" name="count" value="100"></td>
    <td>(optional) actual number of addresses in each subnet</td></tr>
</table>
<br>

<pre>
<button onclick="doStuff()">Calculate!</button>                                                                                       <button onclick="canned1()">Canned example 1</button> <button onclick="canned2()">Canned example 2</button> <button onclick="canned3()">Canned example 3</button>
</pre>
<br><br>
  
<div id="mydiv"></div>

</body>
</html> 
